<div class="dashboard-content">

    <div class="page-header">
        <div class="header-text">
            <h1 *ngIf="!mobileQuery">Bienvenido de nuevo! ðŸ‘‹</h1>
            <h1 *ngIf="mobileQuery">Hola, Alex! ðŸ‘‹</h1>
            <p *ngIf="!mobileQuery">GestiÃ³n integral de tus mascotas</p>
        </div>

        <button mat-flat-button color="warn" (click)="cerrarSesion()">
            <mat-icon>logout</mat-icon>
            <span *ngIf="!mobileQuery">Cerrar SesiÃ³n</span>
        </button>
    </div>

    <div class="stats-grid">
        <mat-card *ngFor="let stat of stats" class="stat-card">
            <mat-card-content>
                <div class="stat-icon" [style.background-color]="stat.color + '20'">
                    <mat-icon [style.color]="stat.color">{{ stat.icon }}</mat-icon>
                </div>
                <div class="stat-info">
                    <div class="stat-label">{{ stat.label }}</div>
                    <div class="stat-value">{{ stat.value }}</div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>

    <h2 class="section-title">Mis Mascotas</h2>

    <div class="carousel-container">
        <button mat-icon-button class="carousel-button left" (click)="scrollLeft()" [disabled]="!canGoBack"
                [style.display]="mobileQuery ? 'none' : 'flex'">
            <mat-icon>chevron_left</mat-icon>
        </button>

        <div class="carousel-track">
            <div *ngIf="mascotas.length === 0" class="empty-message">
                No tienes mascotas registradas.
            </div>

            <mat-card *ngFor="let pet of visibleMascotas" class="mascota-card">
                <div class="mascota-image"
                     [style.background-image]="'url(' + (pet.photoUrl || fallbackImage) + ')'">
                </div>

                <mat-card-content>
                    <div class="mascota-header">
                        <mat-icon class="mascota-icon" [style.color]="'#ff9800'">pets</mat-icon>
                        <div class="mascota-info">
                            <h3 class="mascota-nombre">{{ pet.name }}</h3>
                            <p class="mascota-raza">{{ (pet.breed || 'Sin raza') }} â€¢ {{ pet.species }}</p>
                        </div>
                    </div>

                    <mat-chip-set>
                        <mat-chip class="edad-chip">{{ pet.birthDate || 'Sin fecha' }}</mat-chip>
                    </mat-chip-set>
                </mat-card-content>
            </mat-card>
        </div>

        <button mat-icon-button class="carousel-button right" (click)="scrollRight()" [disabled]="!canGoForward"
                [style.display]="mobileQuery ? 'none' : 'flex'">
            <mat-icon>chevron_right</mat-icon>
        </button>
    </div>

    <h2 class="section-title" style="margin-top: 48px;">PrÃ³ximas Citas</h2>

    <div class="appointments-container">

        <div *ngIf="appointments.length === 0" class="empty-message-citas">
            <p>No tienes citas programadas.</p>
        </div>

        <mat-card *ngFor="let appointment of appointments" class="appointment-card">

            <div class="color-strip" [style.background-color]="getColorForType(appointment.type)"></div>

            <mat-card-content class="card-content-wrapper">

                <div class="appointment-icon-wrapper" [style.background-color]="getColorForType(appointment.type) + '20'">
                    <mat-icon [style.color]="getColorForType(appointment.type)">
                        {{ getIconForType(appointment.type) }}
                    </mat-icon>
                </div>

                <div class="appointment-details">
                    <h3 class="appointment-title">{{ appointment.title }}</h3>

                    <p class="appointment-pet">Para: <strong>{{ appointment.petName }}</strong></p>

                    <div class="appointment-meta">
                        <span class="date-text">
                            {{ appointment.dateTime | date:'mediumDate' }} â€¢ {{ appointment.dateTime | date:'shortTime' }}
                        </span>

                        <span class="status-text" [class]="getStatusClass(appointment.status)">
                            {{ translateStatus(appointment.status) }}
                        </span>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>

        <div class="fab-container">
            <button mat-fab extended color="warn" class="add-pet-btn">
                <mat-icon>add</mat-icon>
                <span>Nuevo</span>
            </button>
        </div>
    </div>

</div>